/**********************************
CPSC 4910 PROJECT DATABASE
CREATED BY: NOAH RIGSBY
TEACHER: ROGER VAN SCOY
GROUP 4
DESCRIPTION: THIS SECTION POPULATES
THE TABLES IN THE DATABASE.
**********************************/

/*TO POPULATE SPONSOR TABLES*/
INSERT INTO DBUSER VALUES (1,'coder343', '10/5/19', '3/4/20');
INSERT INTO SPONSOR VALUES (1, 'State Farm', '3180 W Montague Ave, North Charleston, SC 29418', 1, 'Debit',112986654);

INSERT INTO DBUSER VALUES (2,'ROBO3421', '9/20/20', '3/4/20');
INSERT INTO SPONSOR VALUES ( 2, 'Geico', '1925 Bull St, Columbia, SC 29201', 1, 'Credit',1123556743);

/*TO POPULATE DRIVER TABLES*/
INSERT INTO DBUSER VALUES (3, 'rendo9921', '9/20/20', '3/4/20');
INSERT INTO DRIVER VALUES ( 3, 'Noah Rigsby', 354218, '882 Tiger Road, Clemson, SC 29631', 2849964328, 0);

INSERT INTO DBUSER VALUES (4, 'coder7645', '9/20/20', '3/4/20');
INSERT INTO DRIVER VALUES ( 4, 'Tommy Dong', 542985, '993 Clemson Avenue, Clemson, SC 29631', 4228999793, 0);

/*TO POPULATE ADMIN TABLES*/
INSERT INTO DBUSER VALUES (5,'star343', '9/20/20', '3/4/20');
INSERT INTO ADMINISTRATOR VALUES ( 5, 'ShayyDog', 'Tigers@clemson.edu', 8437756948);

INSERT INTO DBUSER VALUES (6, 'rhino43', '9/20/20', '3/4/20');
INSERT INTO ADMINISTRATOR VALUES ( 6, 'Lowjack31', 'Football@clemson.edu', 8438675309);

/*TO POPULATE APPLICATION TABLE*/
INSERT INTO APPLICATION VALUES (8,'approved',1);
INSERT INTO APPLICATION VALUES (9,'declined',2);

/*TO POPULATE PURCHASE TABLE*/
INSERT INTO PURCHASE VALUES (9,300.97, 'Ordered', '9/5/20', '9/22/20');
INSERT INTO PURCHASE VALUES (10,129.97, 'Shipped', '10/8/20', '10/14/20');

/*TO POPULATE CATALOG TABLE*/
INSERT INTO CATALOG VALUES ('Fall Issue', 1);
INSERT INTO CATALOG VALUES ('Spring Issue', 2);

/*TO POPULATE CATEGORIES TABLE*/
INSERT INTO CATEGORIES VALUES ('issue one', 'Fall Issue');
INSERT INTO CATEGORIES VALUES ('issue two', 'Spring Issue');

/*TO POPULATE GOODBEHAVIORAPP TABLE*/
INSERT INTO GOODBEHAVIORAPP VALUES ('Good app');

/*TO POPULATE PRODUCTS TABLE*/
INSERT INTO PRODUCTS VALUES ('Car Horn', 33.95,'Horn used to yell at drivers','In-Stock', 'Image 1', 90, 'issue one', 223415);
INSERT INTO PRODUCTS VALUES ('Nvidia RTX 3090', 1500.95,'graphics so beautiful you could cry','Out-Of-Stock', 'Image 3', 90000, 'issue two', 225560);

/*TO POPULATE USERTYPE TABLE*/
INSERT INTO USERTYPE VALUES ('Driver', 3);
INSERT INTO USERTYPE VALUES ('Driver', 4);
INSERT INTO USERTYPE VALUES ('Sponsor', 1);
INSERT INTO USERTYPE VALUES ('Sponsor', 2);
INSERT INTO USERTYPE VALUES ('Administrator', 5);
INSERT INTO USERTYPE VALUES ('Administrator', 6);

/*TO POPULATE OPERATION TABLE*/
INSERT INTO OPERATION VALUES ('Driver', 'This is the drivers operation ID. Drivers are users that have access to their account.');
INSERT INTO OPERATION VALUES ('Sponsor', 'This is the Sponsors operation ID. Sponsors are users with access to their page and have a list of drivers');
INSERT INTO OPERATION VALUES ('Administrator', 'This is the Administrators operation ID. Administrators can edit and change the website.');

/*TO POPULATE AWARDED TABLE*/
INSERT INTO AWARDED VALUES (33, '3/10/2021', 2, 3);
INSERT INTO AWARDED VALUES (33, '3/10/2021', 1, 4);

/*TO POPULATE CONTAINS TABLE*/
INSERT INTO CONTAINS VALUES (10, 223415, 9);
INSERT INTO CONTAINS VALUES (2, 223415, 10);

/*TO POPULATE SELECTRULES TABLE*/
INSERT INTO SELECTRULES VALUES (3);
INSERT INTO SELECTRULES VALUES (4);

/*TP POPULATE THE CREATES TABLE*/
INSERT INTO CREATES VALUES (10, 3);
INSERT INTO CREATES VALUES (9, 4);

INSERT INTO SECUREDFOR VALUES ('Driver', 'Driver');
INSERT INTO SECUREDFOR VALUES ('Sponsor', 'Sponsor');

INSERT INTO REVIEWS VALUES (1, 8);
INSERT INTO REVIEWS VALUES (2, 9);

INSERT INTO QUALIFIESFOR VALUES (3, 223415);
INSERT INTO QUALIFIESFOR VALUES (4, 225560);

INSERT INTO EMPLOYS VALUES(1,1,3,0);
INSERT INTO EMPLOYS VALUES(2,1,4,0);

INSERT INTO ASSIGNS VALUES(1,3, 5);
INSERT INTO ASSIGNS VALUES(1,4, 6);

INSERT INTO SWITCHES VALUES(1,3);
INSERT INTO SWITCHES VALUES(2,4);

INSERT INTO OWNS VALUES(223415, 1);
INSERT INTO OWNS VALUES(225560, 2);
/**** STORED PROCEDURE SECTION ****/

/*THIS STORED PROCEDURE GRABS THE DRIVERS NAME, ADDRESS, AND PASSWORD FROM THE DRIVER TABLE AND DBUSER TABLE*/
DELIMITER //
CREATE PROCEDURE drivername()
BEGIN
  SELECT Driver_Name, Driver_Address, User_Password, id  FROM DRIVER, DBUSER
  WHERE id = DBuser_ID;
END //
DELIMITER ;

/*THIS STORED PROCEDURE GRABS THE SPONSORS NAME, ADDRESS, AND PASSWORD FROM THE SPONSOR TABLE AND DBUSER TABLE*/
DELIMITER //
CREATE PROCEDURE sponsorname()
BEGIN
  SELECT Company_Name, Comp_Address, User_Password, Suser_ID  FROM SPONSOR, DBUSER
  WHERE Suser_ID = DBuser_ID;
END //
DELIMITER ;

/*THIS STORED PROCEDURE GRABS THE ADMINISTRATORS NAME, PHONE, AND PASSWORD FROM THE ADMINISTRATOR TABLE AND DBUSER TABLE*/
DELIMITER //
CREATE PROCEDURE adminname()
BEGIN
  SELECT Admin_Name, Admin_Phone, User_Password, Auser_ID  FROM ADMINISTRATOR, DBUSER
  WHERE Auser_ID = DBuser_ID;
END //
DELIMITER ;

/*THIS STORED PROCEDURE GRABS THE DRIVERS NAME AND PASSWORD BASED ON WHAT THE USER SELECTS*/
DELIMITER //
CREATE PROCEDURE login(IN D_Name VARCHAR(300))
BEGIN
  SELECT Driver_Name, User_Password FROM DRIVER, DBUSER WHERE Driver_Name = D_Name AND id = DBuser_ID;
END //
DELIMITER ;

DELIMITER //
CREATE PROCEDURE namestatus(IN D_Name VARCHAR(300))
BEGIN
  SELECT Driver_Name, Users_Type, Description FROM DRIVER, USERTYPE, OPERATION WHERE Driver_Name = D_Name AND Tuser_ID = id AND Users_Type = Operation_ID;
  SELECT Admin_Name, Users_Type, Description FROM ADMINISTRATOR, USERTYPE, OPERATION WHERE Admin_Name = D_Name AND Tuser_ID = Auser_ID AND Users_Type = Operation_ID;
  SELECT Company_Name, Users_Type, Description FROM SPONSOR, USERTYPE, OPERATION WHERE Company_Name = D_Name AND Tuser_ID = Suser_ID AND Users_Type = Operation_ID;

END //
DELIMITER ;

DELIMITER //
CREATE PROCEDURE IDstatus(IN ID_Name int )
BEGIN
  SELECT Admin_Name, Users_Type, Description FROM ADMINISTRATOR, USERTYPE, OPERATION WHERE Tuser_ID = ID_Name AND Tuser_ID = Auser_ID AND Users_Type = Operation_ID;
  SELECT Company_Name, Users_Type, Description FROM SPONSOR, USERTYPE, OPERATION WHERE Tuser_ID = ID_Name AND Tuser_ID = Suser_ID AND Users_Type = Operation_ID;
  SELECT Driver_Name, Users_Type, Description FROM DRIVER, USERTYPE, OPERATION WHERE Tuser_ID = ID_Name AND Tuser_ID = id AND Users_Type = Operation_ID;
END //
DELIMITER ;

/*trigger to keep values of old prices*/
DELIMITER //
CREATE TRIGGER Update_products BEFORE UPDATE
      ON PRODUCTS
      FOR EACH ROW
      BEGIN
      INSERT INTO OLDPRICES values (old.Product_Name, old.Price_Total);
      end; //
DELIMITER ;

/*update PRODUCTS set Price_Total = Price_Total + 5000000 where Product_Name = 'Car Horn';*/

  /*update PRODUCTS set Availability = 'IN-Stock' where Product_Name = 'Nvidia RTX 3090';*/


DELIMITER //
CREATE TRIGGER Update_status AFTER UPDATE
      ON PRODUCTS
      FOR EACH ROW
      BEGIN
      INSERT INTO OLDSTATUS values (old.Product_Name, old.Availability);
      end; //
DELIMITER ;

DELIMITER //
CREATE TRIGGER Delete_Product BEFORE DELETE
      ON ADMINISTRATOR
      FOR EACH ROW
      BEGIN
      INSERT INTO OLDADMIN values (old.Auser_ID, old.Admin_Name, old.Admin_Email, old.Admin_Phone);
      end; //
DELIMITER ;

/*DELETE FROM ADMINISTRATOR where Auser_ID = 6;*/
